<script>
  const gallery = document.getElementById('gallery');
  const modal = document.getElementById('imageModal');
  const modalImage = document.getElementById('modalImage');
  let totalImages = 21;
  let currentImage = totalImages;

  function createGalleryItem(src, alt) {
    const galleryItem = document.createElement('div');
    galleryItem.className = 'gallery-item';
    const img = document.createElement('img');
    img.src = src;
    img.alt = alt;
    img.onerror = () => { img.style.display = 'none'; };
    galleryItem.appendChild(img);
    galleryItem.addEventListener('click', () => {
      if (window.innerWidth <= 768) {
        modalImage.src = src;
        modal.style.display = 'flex';
      }
    });
    return galleryItem;
  }

  function loadFeaturedImages() {
    const featuredImages = [1, 2, 3];
    featuredImages.forEach(num => {
      const item = createGalleryItem(`images/featured-${num}.jpg`, `Featured Image ${num}`);
      gallery.appendChild(item);
    });
  }

  function loadImages(batch = 6) {
    for (let i = 0; i < batch && currentImage >= 1; i++) {
      const item = createGalleryItem(`images/${currentImage}.jpg`, `Gallery Image ${currentImage}`);
      gallery.appendChild(item);
      currentImage--;
    }
  }

  // Load fixed featured images only on mobile
  if (window.innerWidth <= 768) {
    loadFeaturedImages();
  }

  // Load enough to fill screen initially
  loadImages(12);

  // Infinite Scroll
  window.addEventListener('scroll', () => {
    if (window.innerHeight + window.scrollY >= document.body.offsetHeight - 100) {
      loadImages();
    }
  });

  // Modal close
  modal.addEventListener('click', () => {
    modal.style.display = 'none';
  });

  document.addEventListener('keydown', e => {
    if (e.key === 'Escape') modal.style.display = 'none';
  });
</script>
